---
emoji: ğŸ’¾
title: useMemo, useCallback Hook
date: "2022-01-14"
category: React
preview: "'ë¦¬ì•¡íŠ¸ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ìˆ 'ì´ë¼ëŠ” ì±…ì„ ì½ê³  ë°°ìš´ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤. useMemoë¥¼ ì´ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ë°œìƒí•˜ëŠ” ì—°ì‚°ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤. useMemo í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¸ìëŠ” ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜, ë‘ë²ˆì§¸ ì¸ìë¡œ ì˜ì¡´ì„± ë°°ì—´ì´ë‹¤. ì˜ì¡´ì„± ë°°ì—´ì— ìˆëŠ” stateê°’ì´ë‚˜ propsê°’ì´ ë°”ë€Œë©´, ì²«ë²ˆì§¸ ì¸ìì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒˆë¡œìš´ ì—°ì‚° ê²°ê³¼ê°’ì„ ë°˜í™˜í•˜ê³ , ë§Œì•½ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´ ì´ì „ì— ì—°ì‚°í•œ ê°’ì„ ì¬ì‚¬ìš©í•œë‹¤. useCalllbackì€ useMemoì™€ ë¹„ìŠ·í•˜ê²Œ ì£¼ë¡œ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•  ë•Œ ì‚¬ìš©í•œë‹¤. íŠ¹ì • í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³  ì¬ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤."
---

> "ë¦¬ì•¡íŠ¸ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ìˆ "ì´ë¼ëŠ” ì±…ì„ ì½ê³  ë°°ìš´ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤.

# useMemo

- useMemoë¥¼ ì´ìš©í•˜ë©´ **ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ë°œìƒí•˜ëŠ” ì—°ì‚°ì„ ìµœì í™”**í•  ìˆ˜ ìˆë‹¤.
- useMemo í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¸ìëŠ” **ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜**, ë‘ë²ˆì§¸ ì¸ìë¡œ **ì˜ì¡´ì„± ë°°ì—´**ì´ë‹¤.
- ì˜ì¡´ì„± ë°°ì—´ì— ìˆëŠ” stateê°’ì´ë‚˜ propsê°’ì´ ë°”ë€Œë©´, ì²«ë²ˆì§¸ ì¸ìì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒˆë¡œìš´ ì—°ì‚° ê²°ê³¼ê°’ì„ ë°˜í™˜í•˜ê³ , ë§Œì•½ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´ ì´ì „ì— ì—°ì‚°í•œ ê°’ì„ ì¬ì‚¬ìš©í•œë‹¤.

## ì˜ˆì‹œ

```jsx
const getAverage = numbers => {
  console.log("í‰ê· ê°’ ê³„ì‚°ì¤‘...");
  if (numbers.length === 0) return 0;
  const sum = numbers.reduce((value, number) => value + number);
  return sum / numbers.length;
};

const Average = () => {
  const [list, setList] = useState([]);
  const [number, setNumber] = useState("");

  const onChange = e => {
    setNumber(e.target.value);
  };

  const onInsert = () => {
    setList(list.concat(parseInt(number)));
    setNumber("");
  };

  return (
    <div>
      <input type="text" name="number" value={number} onChange={onChange} />
      <button onClick={onInsert}>ë“±ë¡</button>
      <ul>
        {list.map((value, index) => (
          <li key={index}>{value}</li>
        ))}
      </ul>
      <div>í‰ê· ê°’: {getAverage(list)}</div>
    </div>
  );
};
```

- ë¬¸ì œì : ìˆ«ìë¥¼ ë“±ë¡í–ˆì„ ë¿ë§Œ ì•„ë‹ˆë¼ ì¸í’‹ ë‚´ìš©ì´ ìˆ˜ì •ë  ë•Œë„ í‰ê· ê°’ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ê°€ í˜¸ì¶œëœë‹¤. ì™œëƒí•˜ë©´ ì¸í’‹ ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆì„ ë•Œ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ì–´ í•¨ìˆ˜ê°€ ë‹¤ì‹œ í˜¸ì¶œëœë‹¤. í•˜ì§€ë§Œ ì¸í’‹ ë‚´ìš©ì´ ë°”ë€” ë•Œì—ëŠ” í‰ê· ê°’ì„ ê³„ì‚°í•  í•„ìš”ê°€ ì—†ë‹¤.
- `useMemo`ë¥¼ ì´ìš©í•˜ë©´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤. ë Œë”ë§í•˜ëŠ” ê³¼ì •ì—ì„œ íŠ¹ì • ìƒíƒœê°’ì´ ë°”ë€Œì—ˆì„ ë•Œë§Œ ì—°ì‚°ì„ ì‹¤í–‰í•˜ê³ , ë°”ë€Œì§€ ì•Šì•˜ì„ ë•ŒëŠ” ì´ì „ì— ì—°ì‚°í–ˆë˜ ê²°ê³¼ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.

```javascript
import { useMemo } from "react";
const avg = useMemo(() => getAverage(list), [list]); // list ìƒíƒœê°’ì´ ë°”ë€” ë•Œë§Œ í•¨ìˆ˜ í˜¸ì¶œ
```

> ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.

# useCallback

- useMemoì™€ ë¹„ìŠ·í•˜ê²Œ ì£¼ë¡œ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•  ë•Œ ì‚¬ìš©í•œë‹¤.
- useCallbackì€ **íŠ¹ì • í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³  ì¬ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ** ì‚¬ìš©í•œë‹¤.
- ì²«ë²ˆì§¸ ì¸ìëŠ” í•¨ìˆ˜, ë‘ë²ˆì§¸ ì¸ìëŠ” ì˜ì¡´ì„± ë°°ì—´ì´ë‹¤.
- ì˜ì¡´ì„± ë°°ì—´ ì•ˆì— ìˆëŠ” ë‚´ìš©ì´ ë°”ë€Œë©´, ì²«ë²ˆì§¸ ì¸ìì˜ í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ìƒì„±í•˜ê³ , ì•„ë‹ˆë©´ ì´ì „ ë Œë”ë§í•  ë•Œ ìƒì„±í•œ í•¨ìˆ˜ë¥¼ **ì¬ì‚¬ìš©**í•œë‹¤.
- ë§Œì•½ ë‘ë²ˆì§¸ ì¸ìë¡œ ë¹ˆ ë°°ì—´ì„ ì „ë‹¬í•˜ë©´, ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë Œë”ë§í•  ë•Œ ë§Œë“¤ì—ˆë˜ í•¨ìˆ˜ë¥¼ ê³„ì† ì¬ì‚¬ìš©í•œë‹¤.
- ë°˜ë©´, ë‘ë²ˆì§¸ ì¸ìê°€ ìƒëµë˜ì—ˆë‹¤ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§ˆë‹¤ ì²«ë²ˆì§¸ ì¸ìì˜ í•¨ìˆ˜ë¥¼ ìƒì„±í•œë‹¤.
- **í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ íŠ¹ì • ìƒíƒœê°’ì— ì‚¬ìš©í•  ë•ŒëŠ” ê·¸ ê°’ì„ ë°˜ë“œì‹œ ì˜ì¡´ì„± ë°°ì—´ì— í¬í•¨í•´ì•¼ í•œë‹¤.**

## ì˜ˆì‹œ

```jsx
// Before
import { useState, useMemo, useCallback } from "react";

const getAverage = numbers => {
  console.log("í‰ê· ê°’ ê³„ì‚°ì¤‘...");
  if (numbers.length === 0) return 0;
  const sum = numbers.reduce((value, number) => value + number);
  return sum / numbers.length;
};

const Average = () => {
  const [list, setList] = useState([]);
  const [number, setNumber] = useState("");

  const onChange = e => {
    setNumber(e.target.value);
  };

  const onInsert = () => {
    setList(list.concat(parseInt(number)));
    setNumber("");
  };

  const avg = useMemo(() => getAverage(list), [list]);

  return (
    <div>
      <input type="text" name="number" value={number} onChange={onChange} />
      <button onClick={onInsert}>ë“±ë¡</button>
      <ul>
        {list.map((value, index) => (
          <li key={index}>{value}</li>
        ))}
      </ul>
      <div>í‰ê· ê°’: {avg}</div>
    </div>
  );
};
```

- `onChange` í•¨ìˆ˜ëŠ” ìƒíƒœê°’ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ì´ˆê¸° ë Œë”ë§ ì´í›„ ìƒˆë¡œ ìƒì„±í•  í•„ìš”ê°€ ì—†ëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì—, useCallbackì„ ì´ìš©í•˜ì—¬ ë‘ë²ˆì§¸ ì¸ìˆ˜ë¡œ ë¹ˆ ë°°ì—´ì„ ì „ë‹¬í•œë‹¤.
  ```js
  // **GOOD**
  const onChange = useCallback(e => {
    setNumber(e.target.value);
  }, []);
  ```
- `onInsert` í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ì˜ ëª¨ë“  ìƒíƒœê°’(`list`, `number`)ì— ì˜ì¡´í•œë‹¤. ìœ„ ì˜ˆì‹œì˜ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒíƒœê°’ì´ ë³€í•  ë•Œë§Œ ë¦¬ë Œë”ë§í•˜ê¸° ë•Œë¬¸ì— (ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ì—†ë‹¤ëŠ” ì „ì œí•˜ì—), `onInsert` í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ëœë‹¤. ê·¸ë˜ì„œ `onInsert` í•¨ìˆ˜ì—ëŠ” useCallbackì„ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

  ```js
  // **BAD**
  const onInsert = useCallback(() => {
    setList(list.concat(parseInt(number)));
    setNumber("");
  }, [list, number]);
  ```

  - ë§Œì•½ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ìœ¼ë¡œ ì¸í•´ ìœ„ ì˜ˆì‹œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ìì£¼ ë¦¬ë Œë”ë§í•œë‹¤ë©´ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•´ì¤„ í•„ìš”ê°€ ìˆë‹¤.
    > **React.memo()**
    >
    > - í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ë•ŒëŠ” life cycle method ì¤‘ shouldComponentUpdate ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
    > - í•˜ì§€ë§Œ, í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ìƒëª…ì£¼ê¸° ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ React.memoë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.
    > - ì»´í¬ë„ŒíŠ¸ê°€ ì „ë‹¬ë°›ì€ propsê°€ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´ ë¦¬ë Œë”ë§í•˜ì§€ ì•Šë„ë¡ í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.
    >
    > ```jsx
    > export default React.memo(Average);
    > ```

# useMemoì™€ useCallback

- useMemoì™€ useCallbackì€ ì£¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.
- í•˜ì§€ë§Œ ìµœì í™”ì—ëŠ” **trade-off**ê°€ ì¡´ì¬í•œë‹¤. í¼í¬ë¨¼ìŠ¤ë¥¼ ìµœì í™”ì‹œì¼°ì§€ë§Œ, ì»´í“¨í„° ìì› ë“± ì†Œëª¨ë˜ëŠ” ìì›ì´ ìˆë‹¤.
- useMemoì™€ useCallbackì„ ì´ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆì§€ë§Œ **ì˜ì¡´ì„± ë°°ì—´ì„ ê´€ë¦¬í•˜ê³  ë©”ëª¨ì´ì œì´ì…˜ì„ ìœ„í•´ ë©”ëª¨ë¦¬ë¥¼ ì†Œëª¨**í•´ì•¼ í•œë‹¤. ì–´ì©Œë©´ ì´ë“ë³´ë‹¤ ë” í° ëŒ€ê°€ë¥¼ ì¹˜ëŸ¬ì•¼ í•  ìˆ˜ ìˆë‹¤.
- ReactëŠ” [ì–•ì€ ë¹„êµ](http://www.eunnbi.dev/posts/react-state#react-%EC%83%81%ED%83%9C%EC%9D%98-%EB%B6%88%EB%B3%80%EC%84%B1%EC%9D%84-%EC%A7%80%EC%BC%9C%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0)ë¥¼ í†µí•´ ì˜ì¡´ì„± ë°°ì—´ì˜ ìš”ì†Œê°’ì˜ ë³€ê²½ì„ ê°ì§€í•œë‹¤. ì¦‰, ë°°ì—´ ìš”ì†Œì˜ **ì°¸ì¡° ë™ì¼ì„±** ì—¬ë¶€ë¥¼ í†µí•´ ë³€ê²½ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤.
- React.memoë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ propsê°€ ë°”ë€Œì—ˆëŠ”ì§€ í™•ì¸í•  ë•Œë„ **props ê°’ë“¤ì˜ ì°¸ì¡°ê°’ ë³€ê²½ ì—¬ë¶€**ë¥¼ í™•ì¸í•œë‹¤.

```jsx
const Root = () => {
  const [isClicked, setIsClicked] = useState(false);
  const _onClick = useCallback(() => {
    setIsClicked(true);
  }, []); //ì´ˆê¸° ë Œë”ë§í•  ë•Œë§Œ í•¨ìˆ˜ê°€ ìƒì„±ë˜ë©° ì´í›„ì—ëŠ” ë™ì¼í•œ ì°¸ì¡°ê°’ì„ ì‚¬ìš©í•œë‹¤.

  return (
    <>
      <Child onClick={_onClick} />
      <Child onClick={_onClick} />
      <Child onClick={_onClick} />
      ...
    </>
  );
};

// ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ë”ë¼ë„ onClickì˜ ì°¸ì¡°ê°’ì´ ë°”ë€Œì§€ ì•Šìœ¼ë¯€ë¡œ ë¦¬ë Œë”ë§ë˜ì§€ ì•ŠëŠ”ë‹¤.
const Child = React.memo(({ onClick }) => {
  return <button onClick={onClick}>Click Me!</button>;
});
```

> useMemoì™€ useCallbackì€ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ”ë° ë„ì›€ì´ ë˜ì§€ë§Œ, êµ³ì´ ìµœì í™”ê°€ í•„ìš”í•˜ì§€ ì•Šì€ ê³³ì— ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì˜¤íˆë ¤ ì´ë“ë³´ë‹¤ ë¹„ìš©ì´ ë” ë°œìƒí•  ìˆ˜ ìˆë‹¤.

> useMemoëŠ” ë¶ˆí•„ìš”í•œ ê³ ë¹„ìš© ì—°ì‚°ì„ ë§‰ê¸° ìœ„í•´, useCallbackì€ React.memoì™€ í•¨ê»˜ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ì–´ì•¼ í•œë‹¤.
