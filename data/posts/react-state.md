---
emoji: â­
title: state
date: "2022-01-12"
category: React
preview: "'ë¦¬ì•¡íŠ¸ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ìˆ 'ì´ë¼ëŠ” ì±…ì„ ì½ê³  ë°°ìš´ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤. stateë€? ì»´í¬ë„ŒíŠ¸ ìì²´ì ìœ¼ë¡œ ì§€ë‹Œ ê°’ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ê°’ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ì˜ stateëŠ” ê°ì²´ í˜•ì‹ì´ì–´ì•¼ í•œë‹¤. ìƒì„±ì í•¨ìˆ˜ì—ì„œ ì´ˆê¸°í™”í•œ stateëŠ” render ë©”ì„œë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. setStateë¥¼ ì‚¬ìš©í•˜ì—¬ stateë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ë‚œ ë‹¤ìŒì— íŠ¹ì • ì‘ì—…ì„ í•˜ê³  ì‹¶ì„ ë•ŒëŠ” setStateì˜ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¡œ ì½œë°± í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤. âœ¨ setStateì— ê°ì²´ ëŒ€ì‹  í•¨ìˆ˜ ì¸ì ì „ë‹¬í•˜ê¸° ğŸ’¡ React may batch multiple setState() calls into a single update for performance. ğŸ’¡ State Updates are Merged. When you call setState(), React merges the object you provide into the current state."
---

> "ë¦¬ì•¡íŠ¸ë¥¼ ë‹¤ë£¨ëŠ” ê¸°ìˆ "ì´ë¼ëŠ” ì±…ì„ ì½ê³  ë°°ìš´ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤.

# stateë€? (ìƒíƒœ)

**ì»´í¬ë„ŒíŠ¸ ìì²´ì ìœ¼ë¡œ ì§€ë‹Œ ë°ì´í„°**ë¡œ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ê°’ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.

## í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ì˜ state

```jsx
import { Component } from "react";

class Counter extends Component {
  // ìƒì„±ì í•¨ìˆ˜
  constructor(props) {
    // stateì˜ ì´ˆê¸°ê°’ ì„¤ì • (ê°ì²´ í˜•ì‹!)
    this.state = {
      number: 0
    };
  }
  render() {
    const { number } = this.state; // ìƒíƒœ ì¡°íšŒ
    return (
      <div>
        <h1>{number}</h1>
        <button onClick={() => this.setState({ number: number + 1 })}>
          +1
        </button>
      </div>
    );
  }
}

export default Counter;
```

- ì»´í¬ë„ŒíŠ¸ì˜ stateëŠ” ê°ì²´ í˜•ì‹ì´ì–´ì•¼ í•œë‹¤.
- ìƒì„±ì í•¨ìˆ˜ì—ì„œ ì´ˆê¸°í™”í•œ stateëŠ” render ë©”ì„œë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### state ê°ì²´ ì•ˆì— ì—¬ëŸ¬ ê°’ì´ ìˆì„ ë•Œ

```jsx
import { Component } from "react";

class Counter extends Component {
  // stateì˜ ì´ˆê¸°ê°’ ì„¤ì •
  state = {
    number: 0,
    fixedNumber: 0
  };

  constructor(props) {
    super(props);
  }

  render() {
    const { number, fixedNumber } = this.state; // ê°ì²´ ë¹„êµ¬ì¡°í™” í• ë‹¹
    return (
      <div>
        <h1>{number}</h1>
        <h2>ë°”ë€Œì§€ ì•ŠëŠ” ê°’: {fixedNumber}</h2>
        <button onClick={() => this.setState({ number: number + 1 })}>
          +1
        </button>
      </div>
    );
  }
}

export default Counter;
```

### this.setStateê°€ ëë‚œ í›„ íŠ¹ì • ì‘ì—… ì‹¤í–‰í•˜ê¸°

- `setState`ë¥¼ ì‚¬ìš©í•˜ì—¬ stateë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ë‚œ ë‹¤ìŒì— íŠ¹ì • ì‘ì—…ì„ í•˜ê³  ì‹¶ì„ ë•ŒëŠ” `setState`ì˜ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¡œ ì½œë°± í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.

```jsx
const onClick = () => {
  this.setState(
    {
      number: number + 1
    },
    () => {
      console.log("setState í˜¸ì¶œ");
    }
  );
};
```

### âœ¨ setStateì— ê°ì²´ ëŒ€ì‹  í•¨ìˆ˜ ì¸ì ì „ë‹¬í•˜ê¸°

> ğŸ’¡ React may **batch** multiple setState() calls into a single update for performance.<br/>
> ğŸ’¡ State Updates are Merged. When you call setState(), React **merges the object** you provide into the current state.<br/>

- setStateê°€ ì—°ì†ì ìœ¼ë¡œ í˜¸ì¶œë˜ë©´ ì „ë‹¬ ë°›ì€ ê° state(ê°ì²´)ë¥¼ í•©ì¹˜ê³ (merging) í•©ì³ì§„ ë‹¨ì¼ ê°ì²´ì— ëŒ€í•´ `setState()`ë¥¼ ì‹¤í–‰í•œë‹¤.
- merge ê³¼ì •ì—ì„œ ê°™ì€ í”„ë¡œí¼í‹° í‚¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ ê°’ì„ ë®ì–´ì“´ë‹¤.
- ì¦‰, setState()ë¥¼ ì—°ì†ì ìœ¼ë¡œ í˜¸ì¶œí•˜ë©´ **Batch ì²˜ë¦¬(ì¼ê´„ ì²˜ë¦¬)** ë¥¼ í•œë‹¤.
- ì›¹í˜ì´ì§€ ë¶ˆí•„ìš”í•œ ë Œë”ë§ íšŸìˆ˜ë¥¼ ì¤„ì—¬ ì¢€ ë” ë¹ ë¥¸ ì†ë„ë¡œ ë™ì‘í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤.
- í•˜ì§€ë§Œ, setStateë¥¼ ì—°ì†ìœ¼ë¡œ í˜¸ì¶œí•˜ê³  ì‹¶ì„ ë•ŒëŠ” setStateì— ê°ì²´ ëŒ€ì‹  í•¨ìˆ˜ ì¸ìë¥¼ ì „ë‹¬í•œë‹¤.
- ì¸ìë¡œ ì „ë‹¬í•œ í•¨ìˆ˜ëŠ” ì´ì „ ìƒíƒœ (`prevState`)ë¥¼ ì²« ë²ˆì§¸ ì¸ìë¡œ ë°›ê³  ì—…ë°ì´íŠ¸ê°€ ì ìš©ëœ ì‹œì ì˜ `props`ë¥¼ ë‘ ë²ˆì§¸ ì¸ìë¡œ ë°›ëŠ”ë‹¤.

## í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ useState ì‚¬ìš©í•˜ê¸°

- `v16.8` ì´í›„ë¶€í„° `useState` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œë„ stateë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- `useState` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ë°°ì—´ì´ ë°˜í™˜ë˜ëŠ”ë°, ì²«ë²ˆì§¸ ì›ì†ŒëŠ” stateì´ê³ , ë‘ë²ˆì§¸ ì›ì†ŒëŠ” stateë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. (setter í•¨ìˆ˜)
- useState í•¨ìˆ˜ì˜ ì¸ìë¡œ ì´ˆê¸° ìƒíƒœê°’ì´ë‚˜ ì´ˆê¸° ìƒíƒœê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì „ë‹¬í•œë‹¤.

```jsx
import React, { useState } from "react";

function Counter() {
  // ë°°ì—´ ë¹„êµ¬ì¡°í™” í• ë‹¹
  const [number, setNumber] = useState(0);

  const onIncrease = () => {
    setNumber(number + 1); // ì¸ìë¡œ ì „ë‹¬ë°›ì€ ê°’ìœ¼ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸
  };

  const onDecrease = () => {
    setNumber(number - 1);
  };

  return (
    <div>
      <h1>{number}</h1>
      <button onClick={onIncrease}>+1</button>
      <button onClick={onDecrease}>-1</button>
    </div>
  );
}
export default Counter;
```

### í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸

- `setState` í•¨ìˆ˜ì— í•¨ìˆ˜ ì¸ìë¥¼ ì „ë‹¬í•˜ì—¬ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.
- ì´ í•¨ìˆ˜ ì¸ìëŠ” ì „ì˜ ìƒíƒœê°’ì„ ì¸ìë¡œ ë°›ê³  ì—…ë°ì´íŠ¸ëœ ìƒíƒœê°’ì„ ë°˜í™˜í•œë‹¤.

```jsx
// í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸
const onIncrease = () => {
  setNumber(prevNumber => prevNumber + 1);
};

const onDecrease = () => {
  setNumber(prevNumber => prevNumber - 1);
};
```

<br/>

# state ì—…ë°ì´íŠ¸ ì‹œ ì£¼ì˜ì‚¬í•­

- `state` ê°’ì„ ë°”ê¾¸ì–´ì•¼ í•  ë•ŒëŠ” `setState` í˜¹ì€ `useState`ë¥¼ í†µí•´ ì „ë‹¬ë°›ì€ setter í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ë§Œ í•œë‹¤.

```jsx
/* **WRONG** */
this.state.number = this.state.number + 1;
this.state.array = this.state.array.push(2);
this.state.object.value = 5;

const [object, setObject] = useState({ a: 1, b: 1 });
object.b = 2;
```

- ë°°ì—´ì´ë‚˜ ê°ì²´ í˜•íƒœì˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•  ë•ŒëŠ” ë°°ì—´ì´ë‚˜ ê°ì²´ ì‚¬ë³¸ì„ ë§Œë“¤ê³  ê·¸ ì‚¬ë³¸ì„ ì—…ë°ì´íŠ¸í•œ í›„ setState í˜¹ì€ setter í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬í•œë‹¤.
- ì¦‰, ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹œì—ëŠ” ë¶ˆë³€ì„±ì„ ì§€ì¼œì•¼ í•œë‹¤.

## ë¶ˆë³€ì„±ì´ë€?

- **ë©”ëª¨ë¦¬ ì˜ì—­ì—ì„œì˜ ê°’ì´ ë³€ê²½ë  ìˆ˜ ì—†ëŠ” íŠ¹ì§•**ì„ ë§í•œë‹¤.
- ê¸°ë³¸ ìë£Œí˜•ì€ ë©”ëª¨ë¦¬ ì˜ì—­ì— ë°ì´í„°ê°€ í• ë‹¹ëœ ì´ìƒ ê·¸ ì˜ì—­ì˜ ê°’ì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤. (ë¶ˆë³€ì„±)
- ë°˜ë©´, ì°¸ì¡° ìë£Œí˜•ì€ í”„ë¡œí¼í‹°ê°€ ì¡´ì¬í•˜ì—¬ í”„ë¡œí¼í‹°ì˜ ê°’ì„ ì–¼ë§ˆë“ ì§€ ë°”ê¿€ ìˆ˜ ìˆë‹¤. (ê°€ë³€ì„±)
- í”„ë¡œí¼í‹°ë„ ë©”ëª¨ë¦¬ ì˜ì—­ì— í• ë‹¹ë˜ì–´ ì¼ì¢…ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.
- ë³€ìˆ˜ì— í• ë‹¹ëœ ê°’ì„ ë°”ê¿€ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œí¼í‹°ì— ëŒ€í•œ ê°’ë„ ë°”ë€” ìˆ˜ ìˆë‹¤.
- ì°¸ê³ : [ê¸°ë³¸ ìë£Œí˜•ê³¼ ì°¸ì¡° ìë£Œí˜•ì˜ ì°¨ì´ì  - ë¶ˆë³€ê°’ê³¼ ê°€ë³€ê°’](https://www.eunnbi.dev/posts/js-data-type#%EA%B8%B0%EB%B3%B8-%EC%9E%90%EB%A3%8C%ED%98%95%EA%B3%BC-%EC%B0%B8%EC%A1%B0-%EC%9E%90%EB%A3%8C%ED%98%95%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90)

## React ìƒíƒœì˜ ë¶ˆë³€ì„±ì„ ì§€ì¼œì•¼ í•˜ëŠ” ì´ìœ 

- stateê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ê°ì§€í•˜ê¸° ìœ„í•´ **ì–•ì€ ë¹„êµ**ë¥¼ ìˆ˜í–‰í•œë‹¤.
  > ğŸ’¡ ì–•ì€ ë¹„êµ: ì‹¤ì œ ë‚´ë¶€ ê°’ì„ ë¹„êµí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **ë©”ëª¨ë¦¬ ì£¼ì†Œê°’(ì°¸ì¡°ê°’)ì„ ë¹„êµ**í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. ì–•ì€ ë¹„êµëŠ” ê³„ì‚° ë¦¬ì†ŒìŠ¤ë¥¼ ì¤„ì—¬ì£¼ê¸° ë•Œë¬¸ì— íš¨ìœ¨ì ìœ¼ë¡œ `state`ë¥¼ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆë‹¤.
- ì¦‰, stateì˜ ì°¸ì¡°ê°’ì„ ë°”ê¾¸ì§€ ì•Šê³  ë‹¨ìˆœíˆ ë‚´ë¶€ í”„ë¡œí¼í‹°ì˜ ê°’ë§Œ ë°”ê¾¸ì—ˆë‹¤ë©´ ìš°ë¦¬ëŠ” stateê°€ ë°”ë€Œì—ˆë‹¤ê³  ìƒê°í•˜ì§€ë§Œ ë¦¬ì•¡íŠ¸ëŠ” ì´ì „ì˜ stateì™€ ê°™ë‹¤ê³  ì¸ì‹í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•˜ì§€ ì•ŠëŠ”ë‹¤.

> - í˜„ì¬ stateì˜ ë¶ˆë³€ì„±ì„ ì§€í‚¤ë©´ì„œ ê°’ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•œë‹¤. (íŠ¹íˆ, ì°¸ì¡° ìë£Œí˜•ì˜ ê²½ìš°)
> - ìƒˆë¡œìš´ ì°¸ì¡°ê°’ì„ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ë³¸ì„ ë§Œë“¤ê³  ê·¸ ì‚¬ë³¸ì— ê°’ì„ ì—…ë°ì´íŠ¸í•œ í›„, setter í•¨ìˆ˜ì—ê²Œ ì „ë‹¬í•œë‹¤.

### ì–•ì€ ë³µì‚¬

- ìŠ¤í”„ë ˆë“œ ì—°ì‚°ìì˜ ê²½ìš° ì–•ì€ ë³µì‚¬ë¥¼ ìˆ˜í–‰í•œë‹¤. ê¸°ì¡´ ê°ì²´ì˜ í”„ë¡œí¼í‹° ê°’ì„ ë³µì‚¬í•˜ì—¬ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“ ë‹¤.
- í•˜ì§€ë§Œ ë§Œì•½ í”„ë¡œí¼í‹° ê°’ì´ ì°¸ì¡°í˜• ë°ì´í„°ì˜ ê²½ìš° ê·¸ ë°ì´í„°ê°€ ì°¸ì¡°í•˜ëŠ” ì£¼ì†Ÿê°’ë§Œ ë³µì‚¬í•˜ê²Œ ëœë‹¤.
- ê·¸ëŸ¬ë©´ ì „ì²´ì ìœ¼ë¡œ ë´¤ì„ ë•Œ ë¶ˆë³€ì„±ì„ ì§€í‚¤ì§€ ëª»í•œ ê²ƒì´ë‹¤.

### ê¹Šì€ ë³µì‚¬

- ê°ì²´ì˜ í”„ë¡œí¼í‹° ì¤‘ì—ì„œ ê·¸ ê°’ì´ ê¸°ë³¸í˜• ë°ì´í„°ì¼ ê²½ìš°ì— ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ê³ , ì°¸ì¡°í˜• ë°ì´í„°ì¼ ê²½ìš° ë‹¤ì‹œ ë‚´ë¶€ì˜ í”„ë¡œí¼í‹°ì˜ ê°’ë“¤ì„ ë³µì‚¬í•œë‹¤.

> ì°¸ê³ : [ê°ì²´ ë³µì‚¬í•˜ê¸° - ì–•ì€ ë³µì‚¬, ê¹Šì€ ë³µì‚¬](https://www.eunnbi.dev/posts/js-data-type#%EA%B0%9D%EC%B2%B4-%EB%B3%B5%EC%82%AC%ED%95%98%EA%B8%B0)

### immer ë¼ì´ë¸ŒëŸ¬ë¦¬

- immer ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‰½ê³  ì§§ì€ ì½”ë“œë¡œ ì¤‘ì²© ê°ì²´ í˜•íƒœì˜ ìƒíƒœë„ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë©´ì„œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.
- `produce` í•¨ìˆ˜ëŠ” ë‘ ê°œì˜ ì¸ìë¥¼ ë°›ëŠ”ë‹¤. ì²«ë²ˆì§¸ ì¸ìëŠ” ìˆ˜ì •í•˜ê³  ì‹¶ì€ ìƒíƒœì´ê³ , ë‘ë²ˆì§¸ ì¸ìëŠ” ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ì„ ì •ì˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
- ë‘ë²ˆì§¸ ì¸ìë¡œ ì „ë‹¬ëœ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´, `produce` í•¨ìˆ˜ê°€ ë¶ˆë³€ì„± ìœ ì§€ë¥¼ ëŒ€ì‹ í•´ì£¼ë©´ì„œ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë°˜í™˜í•œë‹¤.
- ê·¸ë˜ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ê°ì²´ ì•ˆì— ìˆëŠ” ê°’ì„ ì§ì ‘ ìˆ˜ì •í•˜ê±°ë‚˜, ë°°ì—´ì— ì§ì ‘ì ì¸ ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ëŠ” `push`, `splice` ë“±ì˜ ë©”ì„œë“œë¥¼ ì´ìš©í•´ë„ ëœë‹¤.

```javascript
import produce from "immer";
const nextState = produce(originalState, draft => {
  // ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§
  // draft: ì—…ë°ì´íŠ¸í•  ìƒíƒœ
});
```

> [immer ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•´ ë” ì•Œì•„ë³´ê¸°](https://immerjs.github.io/immer/)

> ì°¸ê³ : [React ê³µì‹ ë¬¸ì„œ](https://reactjs.org/docs/state-and-lifecycle.html#state-updates-may-be-asynchronous)
